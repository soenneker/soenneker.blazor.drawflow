@page "/"
@using Microsoft.Extensions.Logging
@using Soenneker.Blazor.Drawflow.Options
@using Soenneker.Blazor.Drawflow
@inject ILogger<Index> Logger

<h1>Soenneker.Blazor.Drawflow demo</h1>

<Drawflow @ref="_flow" Options="_options" OnNodeCreated="HandleCreated" style="height:500px;border:1px solid gray"></Drawflow>

<button class="btn btn-primary" @onclick="AddSample">Add Node</button>
<button class="btn btn-secondary ms-2" @onclick="ZoomIn">Zoom In</button>
<button class="btn btn-secondary ms-2" @onclick="AddModuleClick">Add Module</button>

@code {
    private Drawflow? _flow;
    private readonly DrawflowOptions _options = new();

    private Task HandleCreated(string id)
    {
        Logger.LogInformation("Node created {Id}", id);
        return Task.CompletedTask;
    }

    private async Task AddSample()
    {
        if (_flow != null)
        {
            await _flow.AddNode("github", 0, 1, 150, 150, "github", new { }, "<div>node</div>");
        }
    }

    private async Task ZoomIn()
    {
        if (_flow != null)
            await _flow.ZoomIn();
    }

    private async Task AddModuleClick()
    {
        if (_flow != null)
            await _flow.AddModule("Other");
    }
}
